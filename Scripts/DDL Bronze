/*
		=========================
			Bronze Tables
		=========================

Creating DDL scripts for Bronze layer.
This script creates tables in the 'bronze' schema, dropping existing tables if they already exist.
--------------------------------------------------------------------------------------------------
*/
USE AdventureWorks
GO

--Before bulk insert inserting in staging table for data cleaning.

IF OBJECT_ID('Bronze.Cus_info','U' )IS NOT NULL
DROP TABLE Bronze.Cus_info
GO

CREATE TABLE Bronze.Cus_Info (
CustomerKey NVARCHAR(MAX),
Prefix NVARCHAR(MAX),
FirstName NVARCHAR(MAX),
LastName NVARCHAR(MAX),
BirthDate NVARCHAR(MAX),
MaritalStatus NVARCHAR(MAX),
Gender NVARCHAR(MAX),
EmailAddress NVARCHAR(MAX),
AnnualIncome NVARCHAR(MAX),
TotalChildren NVARCHAR(MAX),
EducationLevel NVARCHAR(MAX),
Occupation NVARCHAR(MAX),
HomeOwner NVARCHAR(MAX)
)
GO

IF OBJECT_ID('Bronze.Prod_info','U' )IS NOT NULL
DROP TABLE Bronze.Prod_info
GO

CREATE TABLE Bronze.Prod_Info
(
	ProductKey NVARCHAR(MAX),
	ProductSubcategoryKey NVARCHAR(MAX),
	ProductSKU NVARCHAR(MAX),
	ProductName NVARCHAR(MAX),
	ModelName NVARCHAR(MAX),
	ProductDescription NVARCHAR(MAX),
	ProductColor NVARCHAR(MAX),
	ProductSize NVARCHAR(MAX),
	ProductStyle NVARCHAR(MAX),
	ProductCost NVARCHAR(MAX),
	ProductPrice NVARCHAR(MAX)
);
GO

IF OBJECT_ID('Bronze.Calender_info', 'U') IS NOT NULL
DROP TABLE Bronze.Calender_info
GO
CREATE TABLE Bronze.Calender_info(
Dates Date
)
GO

IF OBJECT_ID('Bronze.Prod_Cat', 'U') IS NOT NULL
DROP TABLE Bronze.Prod_Cat
GO

CREATE TABLE Bronze.Prod_Cat(
Product_Cat_Key INT NOT NULL,
Product_Name NVARCHAR(50)
)
GO

IF OBJECT_ID('Bronze.Prod_SubCat','U') IS NOT NULL
DROP TABLE Bronze.Prod_SubCat
GO

CREATE TABLE Bronze.Prod_SubCat(
SubCatKey INT NOT NULL,
SubCatName NVARCHAR(50),
Product_Cat_Key INT
)
GO

IF OBJECT_ID('Bronze.Return_Data','U') IS NOT NULL
DROP TABLE Bronze.Return_Data
GO
CREATE TABLE Bronze.Return_Data(
ReturnDate DATE,
TerritoryKey INT,
ProductKey INT,
ReturnQuantity INT
)
GO

IF OBJECT_ID('Bronze.Sales_2020', 'U') IS NOT NULL
DROP TABLE Bronze.Sales_2020
GO

CREATE TABLE Bronze.Sales_2020(
OrderDate DATE,
StockDate DATE,
OrderNumber NVARCHAR(30),
ProductKey INT,
CustomerKey INT,
TerritoryKey INT,
OrderLineItem INT,
OrderQuantity INT
)
GO

IF OBJECT_ID('Bronze.Sales_2021','U') IS NOT NULL
DROP TABLE Bronze.Sales_2021
GO
CREATE TABLE Bronze.Sales_2021(
OrderDate DATE,
StockDate DATE,
OrderNumber NVARCHAR(30),
ProductKey INT,
CustomerKey INT,
TerritoryKey INT,
OrderLineItem INT,
OrderQuantity INT
)
GO

IF OBJECT_ID('Bronze.Sales_2022','U') IS NOT NULL
DROP TABLE Bronze.Sales_2022
GO
CREATE TABLE Bronze.Sales_2022(
OrderDate DATE,
StockDate DATE,
OrderNumber NVARCHAR(30),
ProductKey INT,
CustomerKey INT,
TerritoryKey INT,
OrderLineItem INT,
OrderQuantity INT
)
GO

IF OBJECT_ID('Bronze.Ter_info','U') IS NOT NULL
DROP TABLE Bronze.Ter_info
GO
CREATE TABLE Bronze.Ter_info(
SalesTerritoryKey INT,
Region NVARCHAR(50),
Country NVARCHAR(50),
Continent NVARCHAR(50)
)
GO

IF OBJECT_ID('Bronze.Cat_Sales','U') IS NOT NULL
DROP TABLE Bronze.Cat_Sales
GO
CREATE TABLE Bronze.Cat_Sales(
Dates DATE,
Prod_Category NVARCHAR(50),
NorthRegion INT,
CentralRegion INT,
SouthRegion INT
)
GO







