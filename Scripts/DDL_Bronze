/*
		=========================
			Bronze Tables
		=========================

Creating DDL scripts for Bronze layer.
This script creates tables in the 'bronze' schema, dropping existing tables if they already exist.
--------------------------------------------------------------------------------------------------
*/
USE AdventureWorks
GO

--Before bulk insert inserting in staging table for data cleaning.

IF OBJECT_ID('Stg_Cus_info','U' )IS NOT NULL
DROP TABLE Stg_Cus_info
GO

CREATE TABLE Stg_Cus_Info (
CustomerKey VARCHAR(50),
Prefix VARCHAR(50),
FirstName VARCHAR(50),
LastName VARCHAR(50),
BirthDate VARCHAR(50),
MaritalStatus VARCHAR(50),
Gender VARCHAR(50),
EmailAddress VARCHAR(100),
AnnualIncome VARCHAR(50),
TotalChildren VARCHAR(50),
EducationLevel VARCHAR(50),
Occupation VARCHAR(50),
HomeOwner VARCHAR(50)
)
GO

IF OBJECT_ID('Bronze_Cus_info','U' )IS NOT NULL
DROP TABLE Bronze_Cus_info
GO

CREATE TABLE Bronze_Cus_info(
CustomerKey INT,
Prefix NVARCHAR(5),
FirstName NVARCHAR(50),
LastName NVARCHAR(50),
BirthDate DATE,
MaritalStatus VARCHAR(10),
Gender VARCHAR(10),
EmailAddress NVARCHAR(50),
AnnualIncome FLOAT,
TotalChildren INT,
EducationLevel NVARCHAR(50),
Occupation NVARCHAR(50),
HomeOwner VARCHAR(10)
)
GO

IF OBJECT_ID('Stg_Prod_info','U' )IS NOT NULL
DROP TABLE Stg_Prod_info
GO

CREATE TABLE Stg_Prod_Info (
ProductKey NVARCHAR(50),
ProductSubcategoryKey NVARCHAR(50),
ProductSKU NVARCHAR(50),
ProductName NVARCHAR(50),
ModelName NVARCHAR(50),
ProductDescription NVARCHAR(50),
ProductColor NVARCHAR(50),
ProductSize NVARCHAR(50),
ProductStyle NVARCHAR(50),
ProductCost NVARCHAR(50),
ProductPrice NVARCHAR(50)
)
GO

IF OBJECT_ID('Bronze_Prod_info', 'U') IS NOT NULL
DROP TABLE Bronze_Prod_info
GO
CREATE TABLE Bronze_Prod_info(
ProductKey INT,
ProductSubcategoryKey INT,
ProductSKU NVARCHAR(20),
ProductName NVARCHAR(50),
ModelName NVARCHAR(20),
ProductDescription NVARCHAR(100),
ProductColor NVARCHAR(20),
ProductSize INT,
ProductStyle INT,
ProductCost FLOAT,
ProductPrice FLOAT
)
GO

IF OBJECT_ID('Bronze_Calender_info', 'U') IS NOT NULL
DROP TABLE Bronze_Calender_info
GO
CREATE TABLE Bronze_Calender_info(
Dates Date
)
GO

IF OBJECT_ID('Bronze_Prod_Cat', 'U') IS NOT NULL
DROP TABLE Bronze_Prod_Cat
GO

CREATE TABLE Bronze_Prod_Cat(
Product_Cat_Key INT NOT NULL,
Product_Name NVARCHAR(50)
)
GO

IF OBJECT_ID('Bronze_Prod_SubCat','U') IS NOT NULL
DROP TABLE Bronze_Prod_SubCat
GO

CREATE TABLE Bronze_Prod_SubCat(
SubCatKey INT NOT NULL,
SubCatName NVARCHAR(50),
Product_Cat_Key INT
)
GO

IF OBJECT_ID('Bronze_Return_Data','U') IS NOT NULL
DROP TABLE Bronze_Return_Data
GO
CREATE TABLE Bronze_Return_Data(
ReturnDate DATE,
TerritoryKey INT,
ProductKey INT,
ReturnQuantity INT
)
GO

IF OBJECT_ID('Bronze_Sales_2020', 'U') IS NOT NULL
DROP TABLE Bronze_Sales_2020
GO

CREATE TABLE Bronze_Sales_2020(
OrderDate DATE,
StockDate DATE,
OrderNumber NVARCHAR(30),
ProductKey INT,
CustomerKey INT,
TerritoryKey INT,
OrderLineItem INT,
OrderQuantity INT
)
GO

IF OBJECT_ID('Bronze_Sales_2021','U') IS NOT NULL
DROP TABLE Bronze_Sales_2021
GO
CREATE TABLE Bronze_Sales_2021(
OrderDate DATE,
StockDate DATE,
OrderNumber NVARCHAR(30),
ProductKey INT,
CustomerKey INT,
TerritoryKey INT,
OrderLineItem INT,
OrderQuantity INT
)
GO

IF OBJECT_ID('Bronze_Sales_2022','U') IS NOT NULL
DROP TABLE Bronze_Sales_2022
GO
CREATE TABLE Bronze_Sales_2022(
OrderDate DATE,
StockDate DATE,
OrderNumber NVARCHAR(30),
ProductKey INT,
CustomerKey INT,
TerritoryKey INT,
OrderLineItem INT,
OrderQuantity INT
)
GO

IF OBJECT_ID('Bronze_Ter_info','U') IS NOT NULL
DROP TABLE Bronze_Ter_info
GO
CREATE TABLE Bronze_Ter_info(
SalesTerritoryKey INT,
Region NVARCHAR(50),
Country NVARCHAR(50),
Continent NVARCHAR(50)
)
GO

IF OBJECT_ID('Bronze_Cat_Sales','U') IS NOT NULL
DROP TABLE Bronze_Cat_Sales
GO
CREATE TABLE Bronze_Cat_Sales(
Dates DATE,
Prod_Category NVARCHAR(50),
NorthRegion INT,
CentralRegion INT,
SouthRegion INT
)
GO









