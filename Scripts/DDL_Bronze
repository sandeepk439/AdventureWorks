/*
		=========================
			Bronze Tables
		=========================

Creating DDL scripts for Bronze layer.
This script creates tables in the 'bronze' schema, dropping existing tables if they already exist.
--------------------------------------------------------------------------------------------------
*/
USE AdventureWorks
GO

--Before bulk insert inserting in staging table for data cleaning.

IF OBJECT_ID('Stg_Cus_info','U' )IS NOT NULL
DROP TABLE Stg_Cus_info
GO

CREATE TABLE Stg_Cus_Info (
CustomerKey NVARCHAR(MAX),
Prefix NVARCHAR(MAX),
FirstName NVARCHAR(MAX),
LastName NVARCHAR(MAX),
BirthDate NVARCHAR(MAX),
MaritalStatus NVARCHAR(MAX),
Gender NVARCHAR(MAX),
EmailAddress NVARCHAR(MAX),
AnnualIncome NVARCHAR(MAX),
TotalChildren NVARCHAR(MAX),
EducationLevel NVARCHAR(MAX),
Occupation NVARCHAR(MAX),
HomeOwner NVARCHAR(MAX)
)
GO

IF OBJECT_ID('Bronze_Cus_info','U' )IS NOT NULL
DROP TABLE Bronze_Cus_info
GO

CREATE TABLE Bronze_Cus_info(
CustomerKey INT,
Prefix NVARCHAR(5),
FirstName NVARCHAR(50),
LastName NVARCHAR(50),
BirthDate DATE,
MaritalStatus VARCHAR(10),
Gender VARCHAR(10),
EmailAddress NVARCHAR(50),
AnnualIncome FLOAT,
TotalChildren INT,
EducationLevel NVARCHAR(50),
Occupation NVARCHAR(50),
HomeOwner VARCHAR(10)
)
GO

IF OBJECT_ID('Stg_Prod_info','U' )IS NOT NULL
DROP TABLE Stg_Prod_info
GO

CREATE TABLE Stg_Prod_Info
(
	ProductKey NVARCHAR(MAX),
	ProductSubcategoryKey NVARCHAR(MAX),
	ProductSKU NVARCHAR(MAX),
	ProductName NVARCHAR(MAX),
	ModelName NVARCHAR(MAX),
	ProductDescription NVARCHAR(MAX),
	ProductColor NVARCHAR(MAX),
	ProductSize NVARCHAR(MAX),
	ProductStyle NVARCHAR(MAX),
	ProductCost NVARCHAR(MAX),
	ProductPrice NVARCHAR(MAX)
);
GO

IF OBJECT_ID('Bronze_Prod_info', 'U') IS NOT NULL
DROP TABLE Bronze_Prod_info
GO
CREATE TABLE Bronze_Prod_info(
ProductKey INT,
ProductSubcategoryKey INT,
ProductSKU NVARCHAR(100),
ProductName NVARCHAR(100),
ModelName NVARCHAR(100),
ProductDescription NVARCHAR(500),
ProductColor NVARCHAR(100),
ProductSize INT,
ProductStyle INT,
ProductCost FLOAT,
ProductPrice FLOAT
)
GO

IF OBJECT_ID('Bronze_Calender_info', 'U') IS NOT NULL
DROP TABLE Bronze_Calender_info
GO
CREATE TABLE Bronze_Calender_info(
Dates Date
)
GO

IF OBJECT_ID('Bronze_Prod_Cat', 'U') IS NOT NULL
DROP TABLE Bronze_Prod_Cat
GO

CREATE TABLE Bronze_Prod_Cat(
Product_Cat_Key INT NOT NULL,
Product_Name NVARCHAR(50)
)
GO

IF OBJECT_ID('Bronze_Prod_SubCat','U') IS NOT NULL
DROP TABLE Bronze_Prod_SubCat
GO

CREATE TABLE Bronze_Prod_SubCat(
SubCatKey INT NOT NULL,
SubCatName NVARCHAR(50),
Product_Cat_Key INT
)
GO

IF OBJECT_ID('Bronze_Return_Data','U') IS NOT NULL
DROP TABLE Bronze_Return_Data
GO
CREATE TABLE Bronze_Return_Data(
ReturnDate DATE,
TerritoryKey INT,
ProductKey INT,
ReturnQuantity INT
)
GO

IF OBJECT_ID('Bronze_Sales_2020', 'U') IS NOT NULL
DROP TABLE Bronze_Sales_2020
GO

CREATE TABLE Bronze_Sales_2020(
OrderDate DATE,
StockDate DATE,
OrderNumber NVARCHAR(30),
ProductKey INT,
CustomerKey INT,
TerritoryKey INT,
OrderLineItem INT,
OrderQuantity INT
)
GO

IF OBJECT_ID('Bronze_Sales_2021','U') IS NOT NULL
DROP TABLE Bronze_Sales_2021
GO
CREATE TABLE Bronze_Sales_2021(
OrderDate DATE,
StockDate DATE,
OrderNumber NVARCHAR(30),
ProductKey INT,
CustomerKey INT,
TerritoryKey INT,
OrderLineItem INT,
OrderQuantity INT
)
GO

IF OBJECT_ID('Bronze_Sales_2022','U') IS NOT NULL
DROP TABLE Bronze_Sales_2022
GO
CREATE TABLE Bronze_Sales_2022(
OrderDate DATE,
StockDate DATE,
OrderNumber NVARCHAR(30),
ProductKey INT,
CustomerKey INT,
TerritoryKey INT,
OrderLineItem INT,
OrderQuantity INT
)
GO

IF OBJECT_ID('Bronze_Ter_info','U') IS NOT NULL
DROP TABLE Bronze_Ter_info
GO
CREATE TABLE Bronze_Ter_info(
SalesTerritoryKey INT,
Region NVARCHAR(50),
Country NVARCHAR(50),
Continent NVARCHAR(50)
)
GO

IF OBJECT_ID('Bronze_Cat_Sales','U') IS NOT NULL
DROP TABLE Bronze_Cat_Sales
GO
CREATE TABLE Bronze_Cat_Sales(
Dates DATE,
Prod_Category NVARCHAR(50),
NorthRegion INT,
CentralRegion INT,
SouthRegion INT
)
GO







